def check_sla_compliance(batch_name, end_datetime):
    """Check if batch completed before its SLA time"""
    if batch_name not in SLA_TIMES:
        return None  # No SLA defined for this batch
    
    sla_time = SLA_TIMES[batch_name]
    sla_datetime = end_datetime.replace(
        hour=sla_time['hour'],
        minute=sla_time['minute'],
        second=0,
        microsecond=0
    )
    
    return 1 if end_datetime <= sla_datetime else 0



                    sla_status = check_sla_compliance(batch_name, end_dt)
                    if sla_status is not None:
                        tags.append(f'sla_met:{sla_status}')
                        # Send SLA compliance as a separate metric (1 = met, 0 = not met)
                        statsd.gauge(
                            f'batch_processing.{batch_name}.sla_compliance',
                            value=sla_status,
                            tags=tags
